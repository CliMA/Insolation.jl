<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mathematical Background · Insolation.jl</title><meta name="title" content="Mathematical Background · Insolation.jl"/><meta property="og:title" content="Mathematical Background · Insolation.jl"/><meta property="twitter:title" content="Mathematical Background · Insolation.jl"/><meta name="description" content="Documentation for Insolation.jl."/><meta property="og:description" content="Documentation for Insolation.jl."/><meta property="twitter:description" content="Documentation for Insolation.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Insolation.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Insolation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../GettingStarted/">Getting Started</a></li><li><a class="tocitem" href="../InsolationExamples/">Examples</a></li><li><a class="tocitem" href="../Milankovitch/">Milankovitch Cycles</a></li><li class="is-active"><a class="tocitem" href>Mathematical Background</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Mean-Anomaly"><span>Mean Anomaly</span></a></li><li><a class="tocitem" href="#True-Anomaly"><span>True Anomaly</span></a></li><li><a class="tocitem" href="#Solar-Longitude"><span>Solar Longitude</span></a></li><li><a class="tocitem" href="#Declination"><span>Declination</span></a></li><li><a class="tocitem" href="#Equation-of-Time"><span>Equation of Time</span></a></li><li><a class="tocitem" href="#Hour-Angle"><span>Hour Angle</span></a></li><li><a class="tocitem" href="#Zenith-Angle"><span>Zenith Angle</span></a></li><li><a class="tocitem" href="#Sunrise/Sunset-Angle"><span>Sunrise/Sunset Angle</span></a></li><li><a class="tocitem" href="#Diurnally-Averaged-Insolation"><span>Diurnally Averaged Insolation</span></a></li><li><a class="tocitem" href="#Azimuth-Angle"><span>Azimuth Angle</span></a></li><li><a class="tocitem" href="#Planet-Star-Distance"><span>Planet-Star Distance</span></a></li></ul></li><li><a class="tocitem" href="../library/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Mathematical Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mathematical Background</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/Insolation.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/Insolation.jl/blob/main/docs/src/SolarGeometry.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solar-Geometry-and-Insolation"><a class="docs-heading-anchor" href="#Solar-Geometry-and-Insolation">Solar Geometry and Insolation</a><a id="Solar-Geometry-and-Insolation-1"></a><a class="docs-heading-anchor-permalink" href="#Solar-Geometry-and-Insolation" title="Permalink"></a></h1><p>This page provides the mathematical formulations used in <code>Insolation.jl</code> to calculate solar geometry and insolation. The equations are from Tapio Schneider and Lenka Novak&#39;s textbook draft <a href="https://climate-dynamics.org/wp-content/uploads/2017/04/Climate_Book.pdf">&quot;Physics of Earth&#39;s Climate&quot;</a>, Chapter 3.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Calculating solar position in the sky and insolation requires a sequence of astronomical computations that determine:</p><ol><li>The planet&#39;s position in its orbit (mean and true anomaly)</li><li>The latitude of the subsolar point (declination)</li><li>The longitude relative to solar noon (hour angle)</li><li>The geometric relationships between the sun and a surface location (zenith and azimuth angles)</li><li>The planet-star distance for radiation calculations</li></ol><h2 id="Mean-Anomaly"><a class="docs-heading-anchor" href="#Mean-Anomaly">Mean Anomaly</a><a id="Mean-Anomaly-1"></a><a class="docs-heading-anchor-permalink" href="#Mean-Anomaly" title="Permalink"></a></h2><p>The <strong>mean anomaly</strong> <span>$M$</span> represents the angular position of a planet in its orbit, assuming uniform circular motion. For an elliptical orbit, this is a convenient starting point for more accurate calculations.</p><p>The mean anomaly at current time <span>$t$</span> is</p><p class="math-container">\[M = \frac{2\pi (t - t_0)}{Y_a} + M_0,\]</p><p>where we have:</p><ul><li>The time at the epoch (J2000), <span>$t_0$</span>, typically defined as January 1, 2000 at 12:00 Terrestrial Time (TT), corresponding to 11:59 UTC</li><li>The mean anomaly at the epoch, <span>$M_0$</span> [radians]</li><li>The length of the anomalistic year, <span>$Y_a$</span> (period from perihelion to perihelion) [seconds]</li></ul><p>The mean anomaly increases linearly with time at a rate of <span>$2\pi/Y_a$</span> radians per second.</p><h2 id="True-Anomaly"><a class="docs-heading-anchor" href="#True-Anomaly">True Anomaly</a><a id="True-Anomaly-1"></a><a class="docs-heading-anchor-permalink" href="#True-Anomaly" title="Permalink"></a></h2><p>The <strong>true anomaly</strong> <span>$A$</span> is the actual angular position of the planet in its elliptical orbit, measured from perihelion (the point of closest approach to the star). Unlike the mean anomaly, the true anomaly accounts for the planet&#39;s varying orbital speed due to Kepler&#39;s laws.</p><p>The true anomaly is computed from the mean anomaly using a series expansion,</p><p class="math-container">\[A = M + \left( 2e - \frac{1}{4}e^{3} \right) \sin(M) + \frac{5}{4} e^2 \sin(2M) + \frac{13}{12} e^3 \sin(3M),\]</p><p>where <span>$e$</span> is the orbital eccentricity. This series approximation is accurate to order <span>$e^3$</span> and is sufficient for Earth&#39;s relatively circular orbit (<span>$e \approx 0.017$</span>).</p><h2 id="Solar-Longitude"><a class="docs-heading-anchor" href="#Solar-Longitude">Solar Longitude</a><a id="Solar-Longitude-1"></a><a class="docs-heading-anchor-permalink" href="#Solar-Longitude" title="Permalink"></a></h2><p>The <strong>solar longitude</strong> <span>$L_s$</span> (also called ecliptic longitude or true longitude) specifies the planet&#39;s position along its orbital path relative to vernal equinox. It combines the orbital phase (true anomaly <span>$A$</span>) with the helioecentric longitude of perihelion <span>$\varpi$</span> (angular distance of perihelion relative to vernal equinox):</p><p class="math-container">\[L_s = A + \varpi.\]</p><p>For Earth, <span>$\varpi$</span> varies slowly due to precession (period <span>$\sim$</span>21,000 years).</p><h2 id="Declination"><a class="docs-heading-anchor" href="#Declination">Declination</a><a id="Declination-1"></a><a class="docs-heading-anchor-permalink" href="#Declination" title="Permalink"></a></h2><p>The <strong>solar declination</strong> <span>$\delta$</span> is the angle between the sun&#39;s rays and the equatorial plane, or the latitude of the subsolar point (where the sun is in zenith at solar noon). It determines the subsolar latitude (where the sun is directly overhead at solar noon). The declination varies between <span>$\pm\gamma$</span> (obliquity) over the course of a year.</p><p>The sine of the declination angle is</p><p class="math-container">\[\sin \delta = \sin \gamma \sin L_s,\]</p><p>where we have:</p><ul><li>The orbital obliquity <span>$\gamma$</span> (axial tilt) [radians]</li><li>The solar longitude <span>$L_s$</span> [radians]</li></ul><p>For Earth&#39;s current obliquity of <span>$\gamma \approx 23.44°$</span>, the declination ranges from <span>$-23.44°$</span> (winter solstice) to <span>$+23.44°$</span> (summer solstice), passing through <span>$0°$</span> at the equinoxes.</p><h2 id="Equation-of-Time"><a class="docs-heading-anchor" href="#Equation-of-Time">Equation of Time</a><a id="Equation-of-Time-1"></a><a class="docs-heading-anchor-permalink" href="#Equation-of-Time" title="Permalink"></a></h2><p>The <strong>equation of time</strong> corrects for the difference between <strong>apparent solar time</strong> (when the sun is actually at its highest point) and <strong>mean solar time</strong> (uniform clock time). This discrepancy arises from two effects:</p><ol><li>The elliptical orbit causes varying orbital speed (eccentricity effect)</li><li>The tilted axis projects the sun&#39;s motion onto the equatorial plane (obliquity effect)</li></ol><p>The equation-of-time hour angle correction [radians] is</p><p class="math-container">\[\Delta \eta = -2 e \sin(M) + \tan^2(\gamma/2) \sin(2M+2\varpi),\]</p><p>where the first term accounts for orbital eccentricity and the second for axial tilt. This can be converted to a time correction through <span>$\Delta t = \Delta\eta T_d/(2\pi)$</span>, where <span>$T_d$</span> is the length of the solar day. The equation of time correction can be up to ±16 minutes for Earth, explaining why sundials and clocks disagree throughout the year.</p><h2 id="Hour-Angle"><a class="docs-heading-anchor" href="#Hour-Angle">Hour Angle</a><a id="Hour-Angle-1"></a><a class="docs-heading-anchor-permalink" href="#Hour-Angle" title="Permalink"></a></h2><p>The <strong>hour angle</strong> <span>$\eta$</span> measures the angular distance of the sun from the local meridian (north-south line). It quantifies how far past (or before) solar noon we are at a given location:</p><ul><li>Local solar noon: <span>$\eta = 0$</span>  </li><li>In the afternoon: <span>$\eta &gt; 0$</span> </li><li>In the morning: <span>$\eta &lt; 0$</span>  </li></ul><p>The hour angle is calculated from the time of day, with equation of time correction, and adjusted for longitude:</p><p class="math-container">\[\eta = \left( \eta_\text{uncorrected} + \Delta\eta \right) + \lambda,\]</p><p>where we have:</p><ul><li>The uncorrected hour angle at the prime meridian (0° longitude), <span>$\eta_\text{uncorrected} = 2\pi t_\text{day}$</span> [radians]</li><li>The fractional time of day at the prime meridian(0 at midnight, 0.5 at noon), <span>$t_\text{day}$</span> [dimensionless]</li><li>The equation of time hour angle correction, <span>$\Delta\eta$</span> [radians]</li><li>The longitude <span>$\lambda$</span> [radians]</li></ul><p>All terms are taken modulo <span>$2\pi$</span> for proper angle wrapping. The factor <span>$2\pi$</span> converts fractional day to angle.</p><h2 id="Zenith-Angle"><a class="docs-heading-anchor" href="#Zenith-Angle">Zenith Angle</a><a id="Zenith-Angle-1"></a><a class="docs-heading-anchor-permalink" href="#Zenith-Angle" title="Permalink"></a></h2><p>The <strong>zenith angle</strong> <span>$\theta$</span> is the angle between the sun&#39;s rays and the vertical direction (zenith) at a location. It determines how directly sunlight strikes a surface:</p><ul><li>Sun directly overhead (zenith): <span>$\theta = 0°$</span> </li><li>Sun at the horizon (sunrise/sunset): <span>$\theta = 90°$</span> </li><li>Sun below the horizon (night): <span>$\theta &gt; 90°$</span> </li></ul><p>The cosine of the zenith angle is</p><p class="math-container">\[\cos \theta = \cos \phi \cos \delta \cos \eta + \sin \phi \sin \delta,\]</p><p>where we have:</p><ul><li>The latitude, <span>$\phi$</span> [radians], positive northward</li><li>The solar declination angle, <span>$\delta$</span> [radians]</li><li>The hour angle, <span>$\eta$</span> [radians]</li></ul><p>This is a fundamental equation in solar geometry. The incident solar radiation is proportional to <span>$\cos \theta$</span>, which is why high solar zenith angles (low sun) produce less heating than low zenith angles (overhead sun).</p><h2 id="Sunrise/Sunset-Angle"><a class="docs-heading-anchor" href="#Sunrise/Sunset-Angle">Sunrise/Sunset Angle</a><a id="Sunrise/Sunset-Angle-1"></a><a class="docs-heading-anchor-permalink" href="#Sunrise/Sunset-Angle" title="Permalink"></a></h2><p>The <strong>sunrise/sunset hour angle</strong> <span>$\eta_d$</span> is the hour angle at which the sun crosses the horizon. It determines the length of day and night:</p><ul><li>Day length = <span>$2\eta_d$</span> (in radians, or multiply by <span>$T_d/(2\pi)$</span> for seconds)</li><li>If <span>$|\tan \phi \tan \delta| &gt; 1$</span>: polar day (<span>$\eta_d = \pi$</span>) or polar night (<span>$\eta_d = 0$</span>)</li></ul><p>The sunrise/sunset hour angle is given by</p><p class="math-container">\[\cos \eta_d = - \tan \phi \tan \delta,\]</p><p>where this equation comes from setting <span>$\theta = 90°$</span> (sun at horizon) in the zenith angle formula. The negative sign reflects that sunrise occurs at negative hour angles and sunset at positive hour angles.</p><h2 id="Diurnally-Averaged-Insolation"><a class="docs-heading-anchor" href="#Diurnally-Averaged-Insolation">Diurnally Averaged Insolation</a><a id="Diurnally-Averaged-Insolation-1"></a><a class="docs-heading-anchor-permalink" href="#Diurnally-Averaged-Insolation" title="Permalink"></a></h2><p>The <strong>diurnally averaged</strong> (daily-mean) insolation requires averaging <span>$\cos \theta$</span> over a full 24-hour period. This is helpful for conceptual models and simpler climate models that do not resolve the full diurnal cycle.</p><p>Since insolation is proportional to <span>$\cos \theta$</span>, we need <span>$\overline{\cos \theta}$</span>, the time-averaged cosine of the zenith angle. This can be computed analytically from the sunrise/sunset hour angle:</p><p class="math-container">\[\overline{\cos \theta} = \frac{1}{\pi} \left( \eta_d \sin \phi \sin \delta + \cos \phi \cos \delta \sin \eta_d \right).\]</p><p><strong>Physical interpretation:</strong></p><ul><li>The <span>$1/\pi$</span> factor normalizes the average over the daylight period</li><li>When <span>$\eta_d = 0$</span> (polar night), <span>$\overline{\cos \theta} = 0$</span> (no insolation)</li><li>When <span>$\eta_d = \pi$</span> (polar day), <span>$\overline{\cos \theta} = \sin \phi \sin \delta$</span> (24-hour average)</li><li>At the equator (<span>$\phi = 0$</span>) during equinox (<span>$\delta = 0$</span>), the formula reduces to <span>$(2/\pi) \cos \phi \cos \delta = 2/\pi \approx 0.637$</span></li></ul><h2 id="Azimuth-Angle"><a class="docs-heading-anchor" href="#Azimuth-Angle">Azimuth Angle</a><a id="Azimuth-Angle-1"></a><a class="docs-heading-anchor-permalink" href="#Azimuth-Angle" title="Permalink"></a></h2><p>The <strong>azimuth angle</strong> <span>$\zeta$</span> specifies the compass direction to the sun, measured from north. It is essential for tracking solar panels, understanding shading, and computing radiation on tilted surfaces.</p><p>The azimuth angle is</p><p class="math-container">\[\zeta = \frac{3\pi}{2} - \arctan \left( \frac{\sin \eta}{\cos \eta \sin \phi - \tan \delta \cos \phi} \right).\]</p><p><strong>Convention in this package:</strong></p><ul><li>Sun due <strong>East</strong>: <span>$\zeta = 0$</span> (or <span>$2\pi$</span>) </li><li>Sun due <strong>North</strong>: <span>$\zeta = \pi/2$</span> </li><li>Sun due <strong>West</strong>: <span>$\zeta = \pi$</span></li><li>Sun due <strong>South</strong>: <span>$\zeta = 3\pi/2$</span> </li></ul><p>The azimuth increases counter-clockwise when viewed from above. At local solar noon (<span>$\eta = 0$</span>), the sun is due south in the Northern Hemisphere (<span>$\zeta = 3\pi/2$</span>) or due north in the Southern Hemisphere.</p><h2 id="Planet-Star-Distance"><a class="docs-heading-anchor" href="#Planet-Star-Distance">Planet-Star Distance</a><a id="Planet-Star-Distance-1"></a><a class="docs-heading-anchor-permalink" href="#Planet-Star-Distance" title="Permalink"></a></h2><p>The <strong>planet-star distance</strong> <span>$d$</span> varies throughout the year due to the elliptical orbit. This variation affects the solar flux received at the top of atmosphere through the inverse square law (<span>$S \propto 1/d^2$</span>).</p><p>The distance is calculated from the equation for the orbital ellipse:</p><p class="math-container">\[d = \frac{1-e^2}{1+e\cos A} d_0,\]</p><p>where we have:</p><ul><li>The orbital eccentricity <span>$e$</span> (0 for circular, <span>$0&lt;e&lt;1$</span> for elliptical) [unitless]</li><li>The true anomaly <span>$A$</span> [radians]</li><li>The semi-major axis <span>$d_0$</span> (mean planet-star distance) [meters]</li></ul><p><strong>For Earth:</strong></p><ul><li>Semi-major axis <span>$d_0 = 1$</span> AU <span>$\approx 1.496 \times 10^{11}$</span> m</li><li>Eccentricity <span>$e \approx 0.0167$</span> (current value, varies over millennia)</li><li>Perihelion (closest): <span>$d \approx 0.983$</span> AU (early January)</li><li>Aphelion (farthest): <span>$d \approx 1.017$</span> AU (early July)</li><li>The <span>$\pm 1.7\%$</span> variation in distance causes a <span>$\pm 3.4\%$</span> variation in solar flux</li></ul><p>Earth is closest to the sun during Northern Hemisphere winter, but the obliquity effect dominates over the distance effect in determining seasons.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Milankovitch/">« Milankovitch Cycles</a><a class="docs-footer-nextpage" href="../library/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Wednesday 29 October 2025 18:01">Wednesday 29 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
