<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · Insolation.jl</title><meta name="title" content="API Reference · Insolation.jl"/><meta property="og:title" content="API Reference · Insolation.jl"/><meta property="twitter:title" content="API Reference · Insolation.jl"/><meta name="description" content="Documentation for Insolation.jl."/><meta property="og:description" content="Documentation for Insolation.jl."/><meta property="twitter:description" content="Documentation for Insolation.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Insolation.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Insolation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../GettingStarted/">Getting Started</a></li><li><a class="tocitem" href="../InsolationExamples/">Examples</a></li><li><a class="tocitem" href="../Milankovitch/">Milankovitch Cycles</a></li><li><a class="tocitem" href="../SolarGeometry/">Mathematical Background</a></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Parameters"><span>Parameters</span></a></li><li><a class="tocitem" href="#Orbital-Parameters"><span>Orbital Parameters</span></a></li><li><a class="tocitem" href="#Insolation-Calculations"><span>Insolation Calculations</span></a></li><li><a class="tocitem" href="#Solar-Geometry"><span>Solar Geometry</span></a></li><li><a class="tocitem" href="#Internal-Functions"><span>Internal Functions</span></a></li><li><a class="tocitem" href="#Type-Aliases"><span>Type Aliases</span></a></li><li><a class="tocitem" href="#Extensions"><span>Extensions</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/Insolation.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/Insolation.jl/blob/main/docs/src/library.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.Insolation" href="#Insolation.Insolation"><code>Insolation.Insolation</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Insolation</code></pre><p>A Julia package to calculate top-of-atmosphere (TOA) insolation (incoming solar radiation) based on Earth&#39;s (or another planetary  body&#39;s) orbital parameters.</p><p>The calculations follow fundamental principles of celestial mechanics and solar geometry, as described in <a href="https://climate-dynamics.org/wp-content/uploads/2017/04/Climate_Book.pdf">&quot;Physics of Earth&#39;s Climate&quot;</a>  by Tapio Schneider and Lenka Novak.</p><p>The package provides functions to:</p><ul><li>Calculate instantaneous insolation for a specific time and location.</li><li>Calculate diurnally averaged insolation.</li><li>Fetch and use orbital parameters (eccentricity, obliquity, and longitude of perihelion) from Laskar et al. (2004)  to compute insolation for paleoclimate studies.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/Insolation.jl#L1-L18">source</a></section></article><p>Complete documentation of the public API for <code>Insolation.jl</code>.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The package provides functions organized into three main categories:</p><ol><li><strong>Parameter Management</strong>: Create and manage physical/orbital parameters</li><li><strong>Solar Geometry</strong>: Calculate solar geometry (zenith angle, azimuth angle, distance)</li><li><strong>Insolation Calculations</strong>: Compute top-of-atmosphere solar radiation</li></ol><h2 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h2><h3 id="Parameter-Structures"><a class="docs-heading-anchor" href="#Parameter-Structures">Parameter Structures</a><a id="Parameter-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Structures" title="Permalink"></a></h3><p><strong><code>InsolationParameters{FT}</code></strong> - The main parameter struct containing physical and orbital constants needed for insolation calculations. See the source code or API documentation for all fields.</p><h3 id="Parameter-Creation"><a class="docs-heading-anchor" href="#Parameter-Creation">Parameter Creation</a><a id="Parameter-Creation-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Creation" title="Permalink"></a></h3><p>The <code>CreateParametersExt</code> extension provides convenient constructors when <code>ClimaParams.jl</code> is loaded. See the Extensions section for details.</p><p>When <code>ClimaParams.jl</code> is available, you can create parameters using:</p><pre><code class="language-julia hljs"># With ClimaParams.jl loaded
using Insolation
params = InsolationParameters(Float64)

# With custom overrides
params = InsolationParameters(Float64, (; tot_solar_irrad = 1365.0))</code></pre><p>Without ClimaParams.jl, create parameters directly:</p><pre><code class="language-julia hljs">using Insolation.Parameters
params = InsolationParameters{Float64}(
    year_anom = 365.259636 * 86400.0,
    day = 86400.0,
    orbit_semimaj = 1.496e11,
    eccentricity_epoch = 0.0167,
    obliq_epoch = deg2rad(23.44),
    lon_perihelion_epoch = deg2rad(282.95),
    tot_solar_irrad = 1362.0,
    epoch = DateTime(2000, 1, 1, 12, 0, 0),
    mean_anom_epoch = deg2rad(357.5291)
)</code></pre><h2 id="Orbital-Parameters"><a class="docs-heading-anchor" href="#Orbital-Parameters">Orbital Parameters</a><a id="Orbital-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Orbital-Parameters" title="Permalink"></a></h2><p>Functions for managing time-varying orbital parameters used in paleoclimate studies.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.orbital_params" href="#Insolation.orbital_params"><code>Insolation.orbital_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">orbital_params(od::OrbitalDataSplines, dt::FT) where {FT &lt;: Real}</code></pre><p>Interpolates time-varying orbital parameters using Milankovitch cycles.</p><p>Interpolates orbital parameters from the Laskar et al. (2004) dataset for paleoclimate studies. The parameters vary over geological timescales.</p><p><strong>Arguments</strong></p><ul><li><code>od::OrbitalDataSplines</code>: The struct containing orbital parameter splines.</li><li><code>dt::FT</code>: The time for interpolation [Years since J2000 epoch].</li></ul><p><strong>Returns</strong></p><ul><li><code>(ϖ, γ, e)</code>: A tuple containing:<ul><li><code>ϖ</code>: Longitude of perihelion [radians]</li><li><code>γ</code>: Obliquity (axial tilt) [radians]</li><li><code>e</code>: Orbital eccentricity [unitless]</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/Insolation.jl#L99-L116">source</a></section><section><div><pre><code class="language-julia hljs">orbital_params(param_set::AIP)</code></pre><p>Returns fixed orbital parameters at epoch.</p><p>Uses the constant orbital parameter values at the reference epoch (typically J2000) stored in the parameter set. Suitable for modern climate simulations where orbital variations are negligible.</p><p><strong>Arguments</strong></p><ul><li><code>param_set::AIP</code>: Parameter struct containing epoch orbital parameters</li></ul><p><strong>Returns</strong></p><ul><li><code>(ϖ, γ, e)</code>: A tuple containing:<ul><li><code>ϖ</code>: Longitude of perihelion at epoch [radians]</li><li><code>γ</code>: Obliquity (axial tilt) at epoch [radians]</li><li><code>e</code>: Orbital eccentricity at epoch [unitless]</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/Insolation.jl#L125-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.OrbitalDataSplines" href="#Insolation.OrbitalDataSplines"><code>Insolation.OrbitalDataSplines</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OrbitalDataSplines</code></pre><p>A container struct that holds cubic spline interpolators for Earth&#39;s orbital parameters, based on the Laskar 2004 dataset.</p><p>The time series of orbital parameters are lazily downloaded from the  <code>orbital_parameters_dataset_path(artifact_dir)</code> path where <code>artifact_dir</code> is  the path and filename to save the artifacts toml file.</p><p>The splines are functions of time (in years since J2000 epoch).</p><p><strong>GPU Support</strong></p><p>This struct is GPU-compatible via Adapt.jl. To transfer to GPU memory:</p><pre><code class="language-julia hljs">using CUDA, Adapt
cpu_od = OrbitalDataSplines()  # Create on CPU
gpu_od = adapt(CuArray, cpu_od)  # Transfer to GPU</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/Insolation.jl#L33-L52">source</a></section></article><h2 id="Insolation-Calculations"><a class="docs-heading-anchor" href="#Insolation-Calculations">Insolation Calculations</a><a id="Insolation-Calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Insolation-Calculations" title="Permalink"></a></h2><p>Main functions for computing top-of-atmosphere solar radiation.</p><h3 id="Instantaneous-Insolation"><a class="docs-heading-anchor" href="#Instantaneous-Insolation">Instantaneous Insolation</a><a id="Instantaneous-Insolation-1"></a><a class="docs-heading-anchor-permalink" href="#Instantaneous-Insolation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.insolation" href="#Insolation.insolation"><code>Insolation.insolation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insolation(θ::FT, d::FT, param_set::IP.AIP) where {FT &lt;: Real}</code></pre><p>Calculates top-of-atmosphere (TOA) insolation and cosine of solar zenith angle.</p><p>Implements <span>$F = S \cos(\theta)$</span> where S is the solar flux at the given planet-star distance. Insolation is set to 0 at night (when <span>$\cos(\theta) &lt; 0$</span>).</p><p><strong>Arguments</strong></p><ul><li><code>θ::FT</code>: Solar zenith angle [radians]</li><li><code>d::FT</code>: Planet-star distance [m]</li><li><code>param_set::IP.AIP</code>: Parameter struct</li></ul><p><strong>Returns</strong></p><ul><li><code>F</code>: TOA insolation [W m⁻²]</li><li><code>S</code>: Solar flux at the given planet-star distance [W m⁻²]</li><li><code>μ</code>: Cosine of solar zenith angle [unitless], clamped to [0, 1]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/InsolationCalc.jl#L22-L39">source</a></section><section><div><pre><code class="language-julia hljs">insolation(
    date::DateTime,
    latitude::FT,
    longitude::FT,
    param_set::IP.AIP,
    orbital_data::Union{OrbitalDataSplines, Nothing} = nothing;
    milankovitch::Bool = false,
    solar_variability::Bool = false,
    eot_correction::Bool = true,
) where {FT &lt;: Real}</code></pre><p>Calculates instantaneous TOA insolation with optional long-term variations in Earth&#39;s orbital parameters (Milankovitch cycles) and solar luminosity.</p><p><strong>Arguments</strong></p><ul><li><code>date::DateTime</code>: Current date and time</li><li><code>latitude::FT</code>: Latitude [degrees]</li><li><code>longitude::FT</code>: Longitude [degrees]</li><li><code>param_set::IP.AIP</code>: Parameter struct</li><li><code>orbital_data::Union{OrbitalDataSplines, Nothing}</code>: (default nothing) Orbital parameter splines. <strong>Required</strong> when <code>milankovitch=true</code> for GPU compatibility.</li><li><code>milankovitch::Bool</code>: (default false) Use time-varying orbital parameters (Milankovitch cycles)</li><li><code>solar_variability::Bool</code>: (default false) Use time-varying solar luminosity</li><li><code>eot_correction::Bool</code>: (default true) Apply equation of time correction</li></ul><p><strong>Returns</strong></p><ul><li><code>F</code>: TOA insolation [W m⁻²]</li><li><code>S</code>: Solar flux [W m⁻²]</li><li><code>μ</code>: Cosine of solar zenith angle [unitless]</li><li><code>ζ</code>: Solar azimuth angle [radians], 0 = due East, increasing counterclockwise</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Modern climate (fixed epoch parameters)
F, S, μ, ζ = insolation(date, lat, lon, param_set)

# Paleoclimate with Milankovitch cycles 
od = OrbitalDataSplines()  # Load once
F, S, μ, ζ = insolation(date, lat, lon, param_set, od; milankovitch=true)

# Without equation of time correction
F, S, μ, ζ = insolation(date, lat, lon, param_set; eot_correction=false)</code></pre><p><strong>GPU Usage</strong></p><p>For GPU execution, create orbital data on CPU and transfer to GPU using Adapt.jl:</p><pre><code class="language-julia hljs">using CUDA, Adapt
cpu_od = OrbitalDataSplines()  # Create on CPU
gpu_od = adapt(CuArray, cpu_od)  # Transfer to GPU
# In GPU kernel:
F, S, μ, ζ = insolation(date, lat, lon, param_set, gpu_od; milankovitch=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/InsolationCalc.jl#L53-L107">source</a></section></article><h3 id="Daily-Averaged-Insolation"><a class="docs-heading-anchor" href="#Daily-Averaged-Insolation">Daily-Averaged Insolation</a><a id="Daily-Averaged-Insolation-1"></a><a class="docs-heading-anchor-permalink" href="#Daily-Averaged-Insolation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.daily_insolation" href="#Insolation.daily_insolation"><code>Insolation.daily_insolation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">daily_insolation(
    date::DateTime,
    latitude::FT,
    param_set::IP.AIP,
    orbital_data::Union{OrbitalDataSplines, Nothing} = nothing;
    milankovitch::Bool = false,
    solar_variability::Bool = false,
) where {FT &lt;: Real}</code></pre><p>Calculates diurnally averaged TOA insolation with optional long-term variations in orbital parameters (Milankovitch cycles) and solar luminosity. The insolation is  averaged over a full day.</p><p><strong>Arguments</strong></p><ul><li><code>date::DateTime</code>: Current date</li><li><code>latitude::FT</code>: Latitude [degrees]</li><li><code>param_set::IP.AIP</code>: Parameter struct</li><li><code>orbital_data::Union{OrbitalDataSplines, Nothing}</code>: (default nothing) Orbital parameter splines. <strong>Required</strong> when <code>milankovitch=true</code> for GPU compatibility.</li><li><code>milankovitch::Bool</code>: (default false) Use time-varying orbital parameters (Milankovitch cycles)</li><li><code>solar_variability::Bool</code>: (default false) Use time-varying solar luminosity (placeholder for future)</li></ul><p><strong>Returns</strong></p><ul><li><code>F</code>: Daily averaged TOA insolation [W m⁻²]</li><li><code>S</code>: Solar flux [W m⁻²]</li><li><code>μ</code>: Daily averaged cosine of solar zenith angle [unitless]</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Modern climate (fixed epoch parameters)
F, S, μ = daily_insolation(date, lat, param_set)

# Paleoclimate with Milankovitch cycles
od = OrbitalDataSplines()  # Load once 
F, S, μ = daily_insolation(date, lat, param_set, od; milankovitch=true)</code></pre><p><strong>GPU Usage</strong></p><p>For GPU execution, create orbital data on CPU and transfer to GPU using Adapt.jl:</p><pre><code class="language-julia hljs">using CUDA, Adapt
cpu_od = OrbitalDataSplines()  # Create on CPU
gpu_od = adapt(CuArray, cpu_od)  # Transfer to GPU
# In GPU kernel:
F, S, μ = daily_insolation(date, lat, param_set, gpu_od; milankovitch=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/InsolationCalc.jl#L139-L186">source</a></section></article><h3 id="Solar-Flux"><a class="docs-heading-anchor" href="#Solar-Flux">Solar Flux</a><a id="Solar-Flux-1"></a><a class="docs-heading-anchor-permalink" href="#Solar-Flux" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.solar_flux" href="#Insolation.solar_flux"><code>Insolation.solar_flux</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solar_flux(d::FT, param_set::IP.AIP) where {FT &lt;: Real}</code></pre><p>Calculates the solar radiative energy flux at the top of the atmosphere (TOA) based on the planet-star distance and the inverse square law.</p><p><strong>Arguments</strong></p><ul><li><code>d::FT</code>: Planet-star distance [m]</li><li><code>param_set::IP.AIP</code>: Struct containing <code>tot_solar_irrad</code> [W m⁻²] and <code>orbit_semimaj</code> [m]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/InsolationCalc.jl#L3-L12">source</a></section></article><h2 id="Solar-Geometry"><a class="docs-heading-anchor" href="#Solar-Geometry">Solar Geometry</a><a id="Solar-Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Solar-Geometry" title="Permalink"></a></h2><p>Functions for calculating solar geometry (distance and solar position in sky). These are typically used internally but can be called directly for specialized applications.</p><h3 id="Instantaneous-Geometry"><a class="docs-heading-anchor" href="#Instantaneous-Geometry">Instantaneous Geometry</a><a id="Instantaneous-Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Instantaneous-Geometry" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.solar_geometry" href="#Insolation.solar_geometry"><code>Insolation.solar_geometry</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solar_geometry(
    date::DateTime,
    latitude::FT,
    longitude::FT,
    (ϖ, γ, e)::Tuple{FT, FT, FT},
    param_set::AIP;
    eot_correction::Bool = true,
) where {FT}</code></pre><p>Calculates planet-star distance, solar zenith angle, and azimuthal angle.</p><p>This is a high-level function that combines all necessary astronomical calculations to determine the planet&#39;s position and distance from the star at a specific time and location.</p><p><strong>Arguments</strong></p><ul><li><code>date::DateTime</code>: Current date and time</li><li><code>latitude::FT</code>: Latitude [degrees]</li><li><code>longitude::FT</code>: Longitude [degrees]</li><li><code>(ϖ, γ, e)::Tuple{FT, FT, FT}</code>: Orbital parameters tuple containing:<ul><li><code>ϖ</code>: Longitude of perihelion [radians]</li><li><code>γ</code>: Obliquity (axial tilt) [radians]</li><li><code>e</code>: Orbital eccentricity [unitless]</li></ul></li><li><code>param_set::AIP</code>: Parameter struct</li><li><code>eot_correction::Bool</code>: (default true) Apply equation of time correction</li></ul><p><strong>Returns</strong></p><ul><li><code>d</code>: Planet-Sun distance [m]</li><li><code>θ</code>: Solar zenith angle [radians]</li><li><code>ζ</code>: Solar azimuth angle [radians], 0 = due East, increasing CCW</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/SolarGeometry.jl#L255-L286">source</a></section></article><h3 id="Daily-Averaged-Geometry"><a class="docs-heading-anchor" href="#Daily-Averaged-Geometry">Daily-Averaged Geometry</a><a id="Daily-Averaged-Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Daily-Averaged-Geometry" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.daily_distance_zenith_angle" href="#Insolation.daily_distance_zenith_angle"><code>Insolation.daily_distance_zenith_angle</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">daily_distance_zenith_angle(
    date::DateTime,
    latitude::FT,
    (ϖ, γ, e)::Tuple{FT, FT, FT},
    param_set::IP.AIP,
) where {FT &lt;: Real}</code></pre><p>Calculates the effective zenith angle for diurnally averaged insolation and  planet-star distance.</p><p>Returns the effective zenith angle corresponding to the diurnally averaged insolation (averaging cos(zenith angle) over 24 hours) and  the planet-star distance for a given date and latitude.</p><p><strong>Arguments</strong></p><ul><li><code>date::DateTime</code>: Current date</li><li><code>latitude::FT</code>: Latitude [degrees]</li><li><code>(ϖ, γ, e)::Tuple{FT, FT, FT}</code>: Orbital parameters tuple containing:<ul><li><code>ϖ</code>: Longitude of perihelion [radians]</li><li><code>γ</code>: Obliquity (axial tilt) [radians]</li><li><code>e</code>: Orbital eccentricity [unitless]</li></ul></li><li><code>param_set::IP.AIP</code>: Parameter struct</li></ul><p><strong>Returns</strong></p><ul><li><code>daily_θ</code>: Effective solar zenith angle [radians]</li><li><code>d</code>: Planet-star distance [m]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/SolarGeometry.jl#L325-L352">source</a></section></article><h2 id="Internal-Functions"><a class="docs-heading-anchor" href="#Internal-Functions">Internal Functions</a><a id="Internal-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-Functions" title="Permalink"></a></h2><p>The following functions are typically used internally but are documented for advanced users and developers who need lower-level access to the calculations.</p><h3 id="Temporal-and-Angular-Calculations"><a class="docs-heading-anchor" href="#Temporal-and-Angular-Calculations">Temporal and Angular Calculations</a><a id="Temporal-and-Angular-Calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Temporal-and-Angular-Calculations" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.mean_anomaly" href="#Insolation.mean_anomaly"><code>Insolation.mean_anomaly</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mean_anomaly(Δt_years::FT, param_set::IP.AIP) where {FT}</code></pre><p>Calculates the mean anomaly at a given time since epoch.</p><p>The mean anomaly is the angle the planet would have traveled from perihelion if it moved in a circular orbit at constant angular velocity.</p><p><strong>Arguments</strong></p><ul><li><code>Δt_years::FT</code>: Time since epoch [years]</li><li><code>param_set::IP.AIP</code>: Parameter struct containing <code>mean_anom_epoch</code></li></ul><p><strong>Returns</strong></p><ul><li><code>MA</code>: Mean anomaly [radians]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/SolarGeometry.jl#L3-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.true_anomaly" href="#Insolation.true_anomaly"><code>Insolation.true_anomaly</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">true_anomaly(MA::FT, e::FT) where {FT &lt;: Real}</code></pre><p>Calculates the true anomaly from the mean anomaly.</p><p>The true anomaly is the actual angular distance of the planet from perihelion along its orbital path. This function uses a series expansion accurate to O(e⁴) where e is the eccentricity (see Fitzpatrick (2012), Appendix A.10).</p><p><strong>Arguments</strong></p><ul><li><code>MA::FT</code>: Mean anomaly [radians]</li><li><code>e::FT</code>: Orbital eccentricity [unitless]</li></ul><p><strong>Returns</strong></p><ul><li><code>TA</code>: True anomaly [radians]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/SolarGeometry.jl#L24-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.solar_longitude" href="#Insolation.solar_longitude"><code>Insolation.solar_longitude</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solar_longitude(TA::FT, ϖ::FT) where {FT &lt;: Real}</code></pre><p>Calculates the solar longitude (ecliptic longitude of the Sun).</p><p>The solar longitude is the angular distance of the planet along its orbital  path, measured from vernal equinox. It is the sum of the true anomaly  (angle from perihelion) and the longitude of perihelion.</p><p><strong>Arguments</strong></p><ul><li><code>TA::FT</code>: True anomaly [radians]</li><li><code>ϖ::FT</code>: Longitude of perihelion [radians]</li></ul><p><strong>Returns</strong></p><ul><li><code>SL</code>: Solar longitude [radians]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/SolarGeometry.jl#L50-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.hour_angle" href="#Insolation.hour_angle"><code>Insolation.hour_angle</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hour_angle(
    date::DateTime,
    λ::FT,
    MA::FT,
    (ϖ, γ, e)::Tuple{FT, FT, FT};
    eot_correction::Bool = true,
) where {FT}</code></pre><p>Calculates the hour angle at a given time and longitude.</p><p>The hour angle is zero at local solar noon and increases with time. Optionally applies the equation of time correction to account for  the difference between apparent and mean solar time.</p><p><strong>Arguments</strong></p><ul><li><code>date::DateTime</code>: Current date and time</li><li><code>λ::FT</code>: Longitude [radians]</li><li><code>MA::FT</code>: Mean anomaly [radians]</li><li><code>(ϖ, γ, e)::Tuple{FT, FT, FT}</code>: Orbital parameters tuple containing:<ul><li><code>ϖ</code>: Longitude of perihelion [radians]</li><li><code>γ</code>: Obliquity (axial tilt) [radians]</li><li><code>e</code>: Orbital eccentricity [unitless]</li></ul></li><li><code>eot_correction::Bool</code>: (default true) Apply equation of time correction</li></ul><p><strong>Returns</strong></p><ul><li><code>η</code>: Hour angle [radians]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/SolarGeometry.jl#L71-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.equation_of_time" href="#Insolation.equation_of_time"><code>Insolation.equation_of_time</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">equation_of_time(MA::FT, (ϖ, γ, e)::Tuple{FT, FT, FT}) where {FT &lt;: Real}</code></pre><p>Calculates the equation of time correction for the hour angle.</p><p>The equation of time accounts for the difference between apparent solar time  (based on the actual Sun&#39;s position in the sky) and mean solar time (based on  a fictitious mean Sun moving at constant speed). This difference arises from  two effects:</p><ol><li>Earth&#39;s elliptical orbit (eccentricity e)</li><li>Earth&#39;s axial tilt (obliquity γ)</li></ol><p><strong>Arguments</strong></p><ul><li><code>MA::FT</code>: Mean anomaly [radians]</li><li><code>(ϖ, γ, e)::Tuple{FT, FT, FT}</code>: Orbital parameters tuple containing:<ul><li><code>ϖ</code>: Longitude of perihelion [radians]</li><li><code>γ</code>: Obliquity (axial tilt) [radians]</li><li><code>e</code>: Orbital eccentricity [unitless]</li></ul></li></ul><p><strong>Returns</strong></p><ul><li><code>Δη</code>: Hour angle correction [radians]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/SolarGeometry.jl#L119-L140">source</a></section></article><h3 id="Distance-and-Utility-Functions"><a class="docs-heading-anchor" href="#Distance-and-Utility-Functions">Distance and Utility Functions</a><a id="Distance-and-Utility-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Distance-and-Utility-Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.planet_star_distance" href="#Insolation.planet_star_distance"><code>Insolation.planet_star_distance</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">planet_star_distance(TA::FT, e::FT, param_set::IP.AIP) where {FT &lt;: Real}</code></pre><p>Calculates the distance between planet (Earth) and star (Sun) at a given  true anomaly.</p><p>The distance varies due to the planet&#39;s elliptical orbit, being shortest at perihelion and longest at aphelion. The calculation uses the orbit equation for an ellipse.</p><p><strong>Arguments</strong></p><ul><li><code>TA::FT</code>: True anomaly [radians]</li><li><code>e::FT</code>: Orbital eccentricity [unitless]</li><li><code>param_set::IP.AIP</code>: Parameter struct containing <code>orbit_semimaj</code></li></ul><p><strong>Returns</strong></p><ul><li><code>d</code>: Planet-star distance [m]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/SolarGeometry.jl#L149-L166">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.years_since_epoch" href="#Insolation.years_since_epoch"><code>Insolation.years_since_epoch</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">years_since_epoch(
    param_set::IP.InsolationParameters{FT},
    date::DateTime,
) where {FT}</code></pre><p>Calculates the time elapsed since epoch (typically J2000) in anomalistic  years (the time from perihelion to perihelion).</p><p>Converts the time difference between two dates from Julian days to anomalistic years, which is the natural time unit for orbital calculations.</p><p><strong>Arguments</strong></p><ul><li><code>param_set::IP.InsolationParameters{FT}</code>: Parameter struct</li><li><code>date::DateTime</code>: Current date and time</li></ul><p><strong>Returns</strong></p><ul><li><code>Δt_years</code>: Time since epoch [anomalistic years]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/SolarGeometry.jl#L177-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.distance_declination_mean_anomaly" href="#Insolation.distance_declination_mean_anomaly"><code>Insolation.distance_declination_mean_anomaly</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">distance_declination_mean_anomaly(
    Δt_years::FT,
    (ϖ, γ, e)::Tuple{FT, FT, FT},
    param_set::IP.AIP,
) where {FT}</code></pre><p>Computes planet-star distance, solar declination angle, and mean anomaly.</p><p>This function calculates key astronomical parameters from orbital elements. The declination determines the subsolar latitude, while the planet-star distance varies due to orbital eccentricity. The mean anomaly is returned for use in hour angle calculations.</p><p><strong>Arguments</strong></p><ul><li><code>Δt_years::FT</code>: Time since epoch [anomalistic years]</li><li><code>(ϖ, γ, e)::Tuple{FT, FT, FT}</code>: Orbital parameters tuple containing:<ul><li><code>ϖ</code>: Longitude of perihelion [radians]</li><li><code>γ</code>: Obliquity (axial tilt) [radians]</li><li><code>e</code>: Orbital eccentricity [unitless]</li></ul></li><li><code>param_set::IP.AIP</code>: Parameter struct</li></ul><p><strong>Returns</strong></p><ul><li><code>d</code>: Planet-star distance [m]</li><li><code>δ</code>: Solar declination angle [radians]</li><li><code>MA</code>: Mean anomaly [radians]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/SolarGeometry.jl#L205-L231">source</a></section></article><h2 id="Type-Aliases"><a class="docs-heading-anchor" href="#Type-Aliases">Type Aliases</a><a id="Type-Aliases-1"></a><a class="docs-heading-anchor-permalink" href="#Type-Aliases" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Insolation.Parameters.AbstractInsolationParams" href="#Insolation.Parameters.AbstractInsolationParams"><code>Insolation.Parameters.AbstractInsolationParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractInsolationParams</code></pre><p>Abstract base type for insolation parameter sets.</p><p>All parameter structs used in <code>Insolation.jl</code> should inherit from this type. The main concrete implementation is <code>InsolationParameters</code>.</p><p>This type hierarchy allows for flexible parameter management and enables package extensions to provide alternative parameter implementations while maintaining API compatibility.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Insolation.jl/blob/9100464c4754428e6f5352eafcda12815de4a988/src/Parameters.jl#L3-L14">source</a></section></article><h2 id="Extensions"><a class="docs-heading-anchor" href="#Extensions">Extensions</a><a id="Extensions-1"></a><a class="docs-heading-anchor-permalink" href="#Extensions" title="Permalink"></a></h2><h3 id="CreateParametersExt"><a class="docs-heading-anchor" href="#CreateParametersExt">CreateParametersExt</a><a id="CreateParametersExt-1"></a><a class="docs-heading-anchor-permalink" href="#CreateParametersExt" title="Permalink"></a></h3><p>The <code>CreateParametersExt</code> extension provides integration with <a href="https://github.com/CliMA/ClimaParams.jl">ClimaParams.jl</a>. When both <code>Insolation.jl</code> and <code>ClimaParams.jl</code> are loaded, this extension enables convenient parameter creation from TOML configuration files, automatically mapping ClimaParams names to Insolation.jl field names.</p><p>See the extension source code in <code>ext/CreateParametersExt.jl</code> for implementation details.</p><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#Insolation.Insolation"><code>Insolation.Insolation</code></a></li><li><a href="#Insolation.OrbitalDataSplines"><code>Insolation.OrbitalDataSplines</code></a></li><li><a href="#Insolation.Parameters.AbstractInsolationParams"><code>Insolation.Parameters.AbstractInsolationParams</code></a></li><li><a href="#Insolation.daily_distance_zenith_angle"><code>Insolation.daily_distance_zenith_angle</code></a></li><li><a href="#Insolation.daily_insolation"><code>Insolation.daily_insolation</code></a></li><li><a href="#Insolation.distance_declination_mean_anomaly"><code>Insolation.distance_declination_mean_anomaly</code></a></li><li><a href="#Insolation.equation_of_time"><code>Insolation.equation_of_time</code></a></li><li><a href="#Insolation.hour_angle"><code>Insolation.hour_angle</code></a></li><li><a href="#Insolation.insolation"><code>Insolation.insolation</code></a></li><li><a href="#Insolation.mean_anomaly"><code>Insolation.mean_anomaly</code></a></li><li><a href="#Insolation.orbital_params"><code>Insolation.orbital_params</code></a></li><li><a href="#Insolation.planet_star_distance"><code>Insolation.planet_star_distance</code></a></li><li><a href="#Insolation.solar_flux"><code>Insolation.solar_flux</code></a></li><li><a href="#Insolation.solar_geometry"><code>Insolation.solar_geometry</code></a></li><li><a href="#Insolation.solar_longitude"><code>Insolation.solar_longitude</code></a></li><li><a href="#Insolation.true_anomaly"><code>Insolation.true_anomaly</code></a></li><li><a href="#Insolation.years_since_epoch"><code>Insolation.years_since_epoch</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../SolarGeometry/">« Mathematical Background</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 23 October 2025 15:16">Thursday 23 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
