<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Zenith Angle Equations · Insolation.jl</title><meta name="title" content="Zenith Angle Equations · Insolation.jl"/><meta property="og:title" content="Zenith Angle Equations · Insolation.jl"/><meta property="twitter:title" content="Zenith Angle Equations · Insolation.jl"/><meta name="description" content="Documentation for Insolation.jl."/><meta property="og:description" content="Documentation for Insolation.jl."/><meta property="twitter:description" content="Documentation for Insolation.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Insolation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Zenith Angle Equations</a><ul class="internal"><li><a class="tocitem" href="#Mean-Anomaly"><span>Mean Anomaly</span></a></li><li><a class="tocitem" href="#True-Anomaly"><span>True Anomaly</span></a></li><li><a class="tocitem" href="#True-Longitude"><span>True Longitude</span></a></li><li><a class="tocitem" href="#Declination"><span>Declination</span></a></li><li><a class="tocitem" href="#Equation-of-Time"><span>Equation of Time</span></a></li><li><a class="tocitem" href="#Hour-Angle"><span>Hour Angle</span></a></li><li><a class="tocitem" href="#Zenith-Angle"><span>Zenith Angle</span></a></li><li><a class="tocitem" href="#Sunrise/Sunset-Angle"><span>Sunrise/Sunset Angle</span></a></li><li><a class="tocitem" href="#Diurnally-averaged-Insolation"><span>Diurnally averaged Insolation</span></a></li><li><a class="tocitem" href="#Azimuth-Angle"><span>Azimuth Angle</span></a></li><li><a class="tocitem" href="#Planet-Sun-Distance"><span>Planet-Sun Distance</span></a></li></ul></li><li><a class="tocitem" href="../InsolationExamples/">Insolation Examples</a></li><li><a class="tocitem" href="../Milankovitch/">Milankovitch Cycles</a></li><li><a class="tocitem" href="../library/">APIs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Zenith Angle Equations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Zenith Angle Equations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/Insolation.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/Insolation.jl/blob/main/docs/src/ZenithAngleEquations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Zenith-Angle-Equations"><a class="docs-heading-anchor" href="#Zenith-Angle-Equations">Zenith Angle Equations</a><a id="Zenith-Angle-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Zenith-Angle-Equations" title="Permalink"></a></h1><p>These equations are from Tapio Schneider and Lenka Novak&#39;s textbook draft, chapter 3.</p><h2 id="Mean-Anomaly"><a class="docs-heading-anchor" href="#Mean-Anomaly">Mean Anomaly</a><a id="Mean-Anomaly-1"></a><a class="docs-heading-anchor-permalink" href="#Mean-Anomaly" title="Permalink"></a></h2><p>The mean anomaly <span>$M$</span> at current time <span>$t$</span> is</p><p class="math-container">\[M = \frac{2\pi (t - t_0)}{Y_a} + M_0,\]</p><p>where <span>$t_0$</span> is the time at the epoch (J2000), defined as January 1, 2000 at 12hr UTC,  <span>$M_0$</span> is the mean anomaly at the epoch, and <span>$Y_a$</span> is the length of the anomalistic year.</p><h2 id="True-Anomaly"><a class="docs-heading-anchor" href="#True-Anomaly">True Anomaly</a><a id="True-Anomaly-1"></a><a class="docs-heading-anchor-permalink" href="#True-Anomaly" title="Permalink"></a></h2><p>The true anomaly <span>$A$</span> is given by</p><p class="math-container">\[A = M + \left( 2e - \frac{1}{4}e^{3} \right) \sin(M) + \frac{5}{4} e^2 \sin(2M) + \frac{13}{12} e^3 \sin(3M).\]</p><h2 id="True-Longitude"><a class="docs-heading-anchor" href="#True-Longitude">True Longitude</a><a id="True-Longitude-1"></a><a class="docs-heading-anchor-permalink" href="#True-Longitude" title="Permalink"></a></h2><p>The true longitude is the sum of the true anomaly and the longitude of perihelion (<span>$\varpi$</span>),</p><p class="math-container">\[L = A + \varpi.\]</p><h2 id="Declination"><a class="docs-heading-anchor" href="#Declination">Declination</a><a id="Declination-1"></a><a class="docs-heading-anchor-permalink" href="#Declination" title="Permalink"></a></h2><p>The sine of the declination angle is</p><p class="math-container">\[\sin \delta = \sin \gamma \sin L,\]</p><p>where <span>$\gamma$</span> is the orbital obliquity.</p><h2 id="Equation-of-Time"><a class="docs-heading-anchor" href="#Equation-of-Time">Equation of Time</a><a id="Equation-of-Time-1"></a><a class="docs-heading-anchor-permalink" href="#Equation-of-Time" title="Permalink"></a></h2><p>The equation of time corrects for the difference between apparent solar time (local solar noon) and mean solar time due to the obliquity of the planet and eccentricity of the orbit,</p><p class="math-container">\[\Delta t = -2 e \sin(M) + \tan^2(\gamma/2) \sin(2M+2\varpi).\]</p><h2 id="Hour-Angle"><a class="docs-heading-anchor" href="#Hour-Angle">Hour Angle</a><a id="Hour-Angle-1"></a><a class="docs-heading-anchor-permalink" href="#Hour-Angle" title="Permalink"></a></h2><p>The hour angle <span>$\eta$</span> measures the longitude difference between the subsolar point position at time <span>$t$</span> and the current location. The hour angle is calculated with respect to the prime meridian and then the longitude is added to calculate the hour angle at the given location.</p><p class="math-container">\[\eta = \eta_UTC + \lambda = \frac{2\pi (t+\Delta t)}{T_d} + \lambda,\]</p><p>where <span>$t$</span> is the current time referenced to the epoch <span>$t_0$</span>, <span>$T_d$</span> is the length of a day, and <span>$\lambda$</span> is the longitude.</p><h2 id="Zenith-Angle"><a class="docs-heading-anchor" href="#Zenith-Angle">Zenith Angle</a><a id="Zenith-Angle-1"></a><a class="docs-heading-anchor-permalink" href="#Zenith-Angle" title="Permalink"></a></h2><p>The zenith angle at any time is given by,</p><p class="math-container">\[\cos \theta = \cos \phi \cos \delta \cos \eta + \sin \phi \sin \delta,\]</p><p>where <span>$\phi$</span> is the latitude.</p><h2 id="Sunrise/Sunset-Angle"><a class="docs-heading-anchor" href="#Sunrise/Sunset-Angle">Sunrise/Sunset Angle</a><a id="Sunrise/Sunset-Angle-1"></a><a class="docs-heading-anchor-permalink" href="#Sunrise/Sunset-Angle" title="Permalink"></a></h2><p>The sunrise/sunset angle is the hour angle <span>$\eta_d$</span> at which the sun rises or sets,</p><p class="math-container">\[\cos \eta_d = - \tan \phi \tan \delta.\]</p><h2 id="Diurnally-averaged-Insolation"><a class="docs-heading-anchor" href="#Diurnally-averaged-Insolation">Diurnally averaged Insolation</a><a id="Diurnally-averaged-Insolation-1"></a><a class="docs-heading-anchor-permalink" href="#Diurnally-averaged-Insolation" title="Permalink"></a></h2><p>The diurnally averaged insolation is obtained from the averaged cosine of the zenith angle, computed in terms of the sunrise/sunset hour angle as</p><p class="math-container">\[\overline{\cos \theta} = \frac{1}{\pi} \left( \eta_d \sin \phi \sin \delta + \cos \phi \cos \delta \cos \eta_d \right).\]</p><h2 id="Azimuth-Angle"><a class="docs-heading-anchor" href="#Azimuth-Angle">Azimuth Angle</a><a id="Azimuth-Angle-1"></a><a class="docs-heading-anchor-permalink" href="#Azimuth-Angle" title="Permalink"></a></h2><p>The azimuth angle is</p><p class="math-container">\[\zeta = \frac{3\pi}{2} - \arctan \left( \frac{\sin \eta}{\cos \eta \sin \phi - \tan \delta \cos \phi} \right).\]</p><p>The azimuth is defined as 0 to the East and increasing counter-clockwise, such that at local solar noon when <span>$\eta=0$</span>, then <span>$\zeta = \frac{3\pi}{2}$</span>.</p><h2 id="Planet-Sun-Distance"><a class="docs-heading-anchor" href="#Planet-Sun-Distance">Planet-Sun Distance</a><a id="Planet-Sun-Distance-1"></a><a class="docs-heading-anchor-permalink" href="#Planet-Sun-Distance" title="Permalink"></a></h2><p>The distance between the planet and the sun depends on the eccentricity of the orbit <span>$e$</span>, true anomaly <span>$A$</span>, and mean planet-sun distance <span>$d_0$</span> through</p><p class="math-container">\[d = \frac{1-e^2}{1+e\cos A} d_0\]</p><p>For the Earth, <span>$d_0 = 1$</span> AU.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../InsolationExamples/">Insolation Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Wednesday 1 November 2023 21:26">Wednesday 1 November 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
